pipeline {
    agent any
    stages {
        stage('PIP Install') {
            steps {
                sh 'pip install -r requirements.txt'
            }
        }
        stage('Linting') {
            steps {
                sh 'linting_command'  // Replace with your linting command
            }
        }
        stage('Build and Push Docker Image') {
            steps {
                script {
                    def dockerImage = docker.build("yanivomc/k8stest:${BUILD_NUMBER}")
                    dockerImage.push()
                }
            }
        }
    }
    post {
        success {
            script {
                // If the build is successful, merge changes into master and update Helm charts
                sh 'git checkout master'
                sh 'git merge development'
                sh 'git push origin master'
                // Update Helm charts with the new Docker image version
                // You need to write this part based on your Helm chart structure
            }
        }
    }
}
